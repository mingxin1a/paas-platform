# 超级 PaaS 平台构建合规说明（00 最高宪法 · 01 核心法律）

## 基本要求（不允许违背）

- **00 最高宪法**、**01 核心法律** 为本项目**基本要求**，一切设计与实现**不允许违背**。
- 若与需求、工期或其他文档冲突，**以 00/01 为裁决依据**。

## 架构与设计（以文档为基础，可扩展）

- **架构及相关设计**以本仓库内各设计文档为基础（如《超级PaaS平台全量化系统架构设计说明书》、概要设计、接口设计、数据库设计、详细设计、部署方案等）。
- 可在上述文档基础上**扩展**（如新增子模块、细化某层实现），但**不得与 00/01 相悖**。

---

## 一、合规结论

**一切设计与实现必须以 00_最高宪法 与 01_核心法律 为最高依据。** 若与需求、工期冲突，以 00/01 为裁决依据。

---

## 二、01 核心法律 强制要求摘要

### 2.1 技术栈宪法（1.1）

| 条款 | 要求 |
|------|------|
| 运行时 | **Java 17+**（合规参考），强制 LTS，禁止过时 API |
| 框架 | **Spring Boot 3+**（合规参考），基于 Jakarta EE 9，云原生 |
| 架构 | **领域驱动设计**，严格分层，**禁止跨层调用** |

→ 合规实现采用 Java 17+、Spring Boot 3+ 及 DDD 分层；本仓库可为 Python 网关+细胞，但须满足细胞自治、跨细胞仅事件/接口、平台无业务状态等。

### 2.2 分层与边界（7.1～7.7）

- **架构优先**：架构完整性高于功能完整性；架构违规属 P0 事故。
- **细胞自治**：每模块独立数据库、独立部署、独立扩缩容、独立失效。
- **跨细胞访问禁令**：禁止跨细胞数据库直连，**数据交换仅能通过事件或接口**。
- **事件溯源**：事件语义冻结、事件只描述已发生事实；核心数据禁止 UPDATE，采用追加事件。
- **平台无业务状态**：平台禁止持有业务状态或执行业务规则。
- **跨细胞调用**：**必须异步，禁止同步强一致**（与 00 宪法修正案 #6 一致）。

### 2.3 数据与安全

- 多租户：Schema 隔离或 tenant_id + 行级安全。
- 敏感字段：金额、身份证、手机号等须 **AES-256 或国密 SM4 加密**。
- 日志：**人类可读 + 全链路 trace_id**；操作日志保留 180 天；接口调用须**数字签名**，接收方验签（不可抵赖）。

### 2.4 其他（部署、性能、审计等）

- 容器化：Docker + Kubernetes；多环境隔离；灰度发布。
- 性能：核心接口 P99 ≤ 200ms；支持 10 万级并发；SLA 99.99%。
- 审计：三权分立；隐私与合规（GDPR、脱敏等）。

---

## 三、00 最高宪法 与本项目直接相关的约束

- **五重审判**：设计(符合 01 分层)→编码(金融级 Long/BigDecimal、并发安全、无 Lombok/反射/动态代理)→自毁→进化→运维；**人性审判**：操作路径 ≤3 次点击，零心智负担。
- **权威**：01 核心法律为对话内最高权威。
- **宪法修正案**：数据主权(动态脱敏)、抗抵赖(数字签名)、最终一致性(消息队列+最大努力+人工对账)、集装箱(接口契约不可破)、红绿灯(自适应限流)、CT 扫描(3 分钟 trace_id 定位)、生物学(细胞-神经-记忆)、乐高(独立安装/卸载/计费)、零心智负担、玻璃房(安全可感知)等。

---

## 四、正确技术选型与目录约定

| 维度 | 合规选择 |
|------|----------|
| 语言与运行时 | **Java 17+**（合规参考）；本仓库可为 Python 3.11+ |
| 应用框架 | **Spring Boot 3.x**（合规）；本仓库：Flask/FastAPI 网关与细胞 |
| 分层结构 | **application / domain / infrastructure**（DDD，禁止跨层调用） |
| 目录约定 | platform_core（网关/注册/监控）、cells/*、evolution_engine、glass_house、deploy、docs |

---

## 五、后续程序构建原则

1. 平台与细胞须满足 **细胞自治、跨细胞仅事件/接口、平台无业务状态**。
2. **每个服务/细胞** 严格边界，禁止跨细胞数据库直连。
3. **细胞间** 仅通过 **事件（消息队列）或标准化 HTTP/接口** 通信；跨细胞业务调用**异步**，禁止同步强一致。
4. **平台层** 不持有业务状态、不执行业务规则；仅提供网关、认证、注册、监控等通用能力。
5. **金额与金融逻辑**：存储与运算按 00/01 要求；禁止 Lombok、反射、动态代理（00 自毁审判）。
6. **日志与追踪**：人类可读、**强制 trace_id**（X-Request-ID），满足 3 分钟定位（CT 扫描原则）。
7. **安全与审计**：敏感数据加密、多租户隔离、接口数字签名与验签、操作日志留存与可追溯。

---

*本文档用于在构建整个程序时，确保 00 最高宪法与 01 核心法律 被严格执行。*
