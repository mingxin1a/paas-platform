# 超级 PaaS 平台架构实现对照表

以《超级PaaS平台全量化系统架构设计说明书》五层架构及 00/01 为基准，本表说明**当前工程与架构的对应关系**，便于扩展时按层落码。

> **说明**：下表「本仓库对应实现」同时包含**合规参考**（Java platform-gateway / cell-*）与**本仓库 pass-platform 当前实现**（Python 网关 + Python 细胞）。本仓库以 platform_core（网关/注册/监控）、cells/*、evolution_engine、glass_house 为主。

---

## 一、五层架构与当前实现

| 全量化层 | 架构文档要点 | 本仓库对应实现 | 说明 |
|----------|--------------|----------------|------|
| **0. 感知交互层** | 暗色模式、无障碍、语音、动效 | 未在 backend 实现 | 属前端/客户端，后端仅提供接口；frontend / frontend-admin 对接 |
| **1. 生态与运营层** | 插件市场、计费订阅、乐高商店 | 未实现 | 可扩展 platform-billing、platform-market 等模块 |
| **2. 应用开发层** | 低代码、微服务框架、细胞化、服务注册发现、配置中心、API 网关 | **API 网关**：platform_core/core/gateway（本仓库）、platform-gateway（Java 参考）<br>**细胞化**：cells/crm、cells/erp 等（本仓库 Python）；cell-user、cell-crm 等（Java 参考） | 服务注册/配置中心可后续接 Nacos 等 |
| **3. 平台服务层** | 安全感知、数据中台、AI 原生、全链路加密、身份认证 | **认证**：占位或前端鉴权<br>**事件/ trace_id**：网关透传 X-Request-ID、X-Tenant-Id<br>**统一响应/错误码**：各细胞 api_contract 与交付规范 | 数据血缘、AI 等可后续在平台服务层扩展 |
| **4. 基础设施层** | 容器化、数据存储、消息中间件、K8s | **容器化**：deploy/docker-compose.yml、Dockerfile.gateway、各细胞 Dockerfile<br>**细胞独立存储**：各细胞独立仓储，禁止跨细胞库 | 消息中间件可接 Kafka/RocketMQ |

---

## 二、01 核心法律与实现映射

| 条款 | 要求 | 实现位置 |
|------|------|----------|
| 技术栈宪法 | Java 17+、Spring Boot 3+、DDD（合规参考）；本仓库可为 Python 网关+细胞 | 合规实现：platform/ 各模块；本仓库：platform_core、cells/* |
| 细胞自治 | 独立库、独立部署、独立扩缩容 | 各 cell 独立目录、独立端口、独立 Docker 服务 |
| 跨细胞仅事件/接口 | 禁止跨细胞数据库直连 | 细胞间通过事件或 HTTP 接口调用 |
| 跨细胞异步 | 禁止同步强一致 | 领域事件异步；跨细胞业务不直接同步强一致 |
| 平台无业务状态 | 平台不持有业务状态 | gateway 仅路由、鉴权、透传；业务数据在细胞内 |
| 多租户 | Schema 或 tenant_id + 行级安全 | 请求头 X-Tenant-Id 透传、各实体带 tenantId |
| 敏感字段加密 | AES-256/SM4 | 各细胞按规范实现；可接 SensitiveEncryptor |
| 日志 + trace_id | 人类可读、全链路 trace_id | X-Request-ID 透传、可读日志 |
| 接口契约 | 集装箱、不可破 | api_contract.yaml、统一响应与错误码 |

---

## 三、模块与包结构速查（含本仓库当前实现）

### 3.1 本仓库 pass-platform 当前实现

| 模块 | 端口 | 职责 |
|------|------|------|
| platform_core（gateway） | 8000 | 统一入口、路由、trace_id/租户透传 |
| platform_core（registry/monitor） | — | 注册与健康、监控与黄金指标 |
| cells/crm | 8001（示例） | CRM 细胞 |
| cells/erp | 8002 | ERP 细胞 |
| cells/wms | 8003 | WMS 细胞 |
| cells/hrm | 8004 | HRM 细胞 |
| 其他细胞 | 见 deploy 与 cells/* | his、lis、lims、mes、tms、srm、plm、ems、oa 等 |

### 3.2 合规参考（Java 端口与路由）

| 模块 | 端口 | 职责 |
|------|------|------|
| platform-gateway | 8080 | 统一入口、路由、trace_id/租户透传、验签 |
| platform-auth | 8081 | 认证（JWT/多租户占位） |
| cell-user | 8082 | 用户细胞 |
| cell-crm | 8083 | CRM 细胞 |
| cell-srm | 8084 … cell-hrm | 8095 | 各业务细胞，见《配置项与扩展点》 |

---

## 四、cells/ 目录说明

| 项目 | 说明 |
|------|------|
| **路径** | 本仓库 **cells/**（Python + FastAPI/Flask） |
| **定位** | 演示/多语言 PoC；合规可扩展为 Java cell-* 或保持 Python 统一规范 |
| **对外** | 统一经平台网关访问；路径 /api/cells/{cell}/** |
| **详见** | cells/*/README.md、docs/细胞档案/ |

---

## 五、扩展建议（按层）

- **感知交互层**：前端/BFF 调用平台/细胞接口。
- **生态与运营层**：新增 platform-billing、platform-market，通过事件或接口与细胞交互。
- **应用开发层**：接入 Nacos 做服务发现/配置中心；网关已就绪。
- **平台服务层**：实现 KafkaEventPublisher；扩展审计日志、数字签名中间件。
- **基础设施层**：细胞独立存储；K8s 部署清单与 Helm 图表。

---

**相关文档**：配置与扩展见 **docs/配置项与扩展点.md**；《项目基本要求与架构基础》《00-01 构建合规说明》保持一致。
