# 全模块前端功能适配说明

## 一、批次1 模块（CRM/ERP/OA/SRM）

- **列表与详情**：沿用通用 `CellList`、`CellDetail`，按 `config/cells.ts` 的 path、listKey、idKey、labelMap 展示。
- **新建闭环**：为 CRM、ERP、OA、SRM 配置 `createFields`，列表页展示「新建」按钮，跳转 `/cell/:cellId/new` 使用通用 `CellCreate` 页；表单含必填校验、错误提示，提交后跳回列表。
- **导出**：CRM/ERP 保留「导出 CSV」，经网关 `exportPath` 下载。

## 二、批次2 模块（MES/WMS/TMS）

- **MES 生产看板**：`BoardView` 对 cellId=mes 时拉取 `/work-orders`，按 status 分组为「待开工/进行中/已完成」三列展示。
- **WMS 扫码**：`ScanOperate` 保留扫码入库/出库表单，经网关 `/scan/inbound`、`/scan/outbound` 提交；列表页入口「扫码」。
- **TMS 轨迹**：`TrackView` 支持按运单 ID 查询轨迹，时间轴展示节点与时间；顶部增加轨迹地图占位（可后续接入高德/百度地图 API）。

## 三、批次3 模块（HIS/LIS 等）

- **HIS 就诊**：新增 `HisVisit` 页（`/cell/his/visits`），就诊列表 + 新建就诊（患者ID、科室）；HIS 列表页入口「就诊管理」。
- **LIS 检验报告**：新增 `LisReport` 页（`/cell/lis/reports`），报告列表、按样本ID筛选、审核状态展示；LIS 列表页入口「检验报告」。
- EMS/PLM/LIMS 继续使用通用列表与详情，配置见 `config/cells.ts`。

## 四、管理端（frontend-admin）全平台运维

- **租户管理**：`TenantManage` 页，对接 `/api/admin/tenants`，表格展示租户列表。
- **细胞治理**：保留 `CellManage`（列表与启用、路由配置、接入校验、权限配置）。
- **监控大盘**：`Monitoring` 展示健康度、细胞状态，并支持 `VITE_GRAFANA_URL` 配置跳转 Grafana。
- **审计日志**：保留 `Audit`，对接 `/api/admin/audit`。
- **告警管理**：`AlertManage` 页，对接 `/api/admin/alerts`。
- **系统配置**：`SystemConfig` 页，对接 `/api/admin/config`。
- 侧栏导航已增加：概览、细胞治理、租户管理、权限配置、审计日志、监控大盘、告警管理、系统配置。

## 五、UI 与权限

- 样式统一使用 `index.css` 中的 CSS 变量（颜色、圆角、间距），见 `frontend/docs/UI设计规范.md`。
- 列表/详情/空态/加载/错误复用 `CellList.module.css`、`CellDetail.module.css` 等既有类名。
- 侧栏细胞列表由 `useAllowedCells` 从网关拉取并按用户 `allowedCells` 过滤，无权限的细胞不展示；无权限访问具体细胞时提示并提供返回。

## 六、代码规范与测试

- **ESLint**：`.eslintrc.cjs` 配置 TypeScript + React Hooks，`npm run lint` 校验。
- **注释**：关键页面与 API 已补充注释。
- **测试**：Vitest + @testing-library/react，`npm run test` / `npm run test:watch`；覆盖率目标 ≥35%（阈值已配置），当前约 41%；提升至 60% 可继续为 CellList、BoardView、ScanOperate、TrackView、HisVisit、LisReport 等页增加用例。

## 七、路由一览

**前端控制台（frontend）**

| 路径 | 说明 |
|------|------|
| `/` | 概览 Dashboard |
| `/cell/:cellId` | 细胞列表 |
| `/cell/:cellId/new` | 新建（有 createFields 的细胞） |
| `/cell/:cellId/detail/:id` | 详情 |
| `/cell/:cellId/board` | 看板（MES/WMS/TMS） |
| `/cell/:cellId/scan` | 扫码（WMS） |
| `/cell/:cellId/tracks` | 轨迹（TMS） |
| `/cell/his/visits` | HIS 就诊 |
| `/cell/lis/reports` | LIS 检验报告 |
| `/audit` | 数据访问记录 |

**管理端（frontend-admin）**

| 路径 | 说明 |
|------|------|
| `/` | 概览 |
| `/cells` | 细胞治理 |
| `/tenants` | 租户管理 |
| `/users` | 权限配置 |
| `/audit` | 审计日志 |
| `/monitoring` | 监控大盘 |
| `/alerts` | 告警管理 |
| `/config` | 系统配置 |
