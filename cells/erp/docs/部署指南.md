# ERP 细胞 - 部署指南

**版本**：1.2.0

## 1. 部署方式

- **独立运行**：本目录执行 `docker compose up -d` 或 `python src/app.py`，监听 `PORT`（默认 8002）。
- **平台联调**：网关将 `/api/v1/erp/*` 转发至本细胞，需配置 `CELL_ERP_URL`。

## 2. 环境变量

| 变量 | 说明 |
|------|------|
| `PORT` | 服务端口，默认 8002 |
| `X-Tenant-Id` | 由网关或调用方传入，多租户隔离 |
| `CELL_VERIFY_SIGNATURE` | 设为 `1` 时启用网关验签 |
| `CELL_SIGNING_SECRET` | 验签密钥（与网关一致），支持 `base64:` 前缀 |
| `CELL_SECURITY_AUDIT_PATH` | 可选，安全审计日志文件路径 |
| `DATABASE_URL` | 预留；接入数据库时配置连接串 |

## 3. 依赖

- Python 3.10+，Flask。当前为内存存储；生产可对接独立数据库（见 `database_schema.sql`，含软删除字段与外键）。

## 4. 验证

- `GET {CELL_URL}/health` 返回 200。
- 项目根执行：`./run.sh verify erp` 或 `./scripts/verify_delivery.sh erp`。
- 本目录执行：`python -m pytest tests/ -v` 运行单元与验收测试。
