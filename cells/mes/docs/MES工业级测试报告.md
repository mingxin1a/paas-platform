# MES 工业级测试报告

**版本**：1.0 | **细胞**：MES | **测试类型**：功能、性能、追溯性

## 1. 测试环境

- 细胞：MES（Flask），端口 8006
- 请求头：X-Tenant-Id、X-Request-ID（POST）、X-Workshop-Id（车间过滤）

## 2. 功能测试范围

| 模块 | 用例 | 说明 |
|------|------|------|
| 工单 | 列表/创建/更新，车间过滤 | 数据权限：车间主任只看本车间 |
| BOM | 列表/创建 | 幂等 |
| 生产计划 | 列表/创建 | 幂等 |
| 生产订单 | 列表/创建，车间过滤 | 幂等 |
| 领料 | 创建领料单、执行领料 | 防超领校验 |
| 报工 | 列表、批量报工（100+ 工序） | 单次≤200 |
| 生产入库 | 创建 | 幂等（X-Request-ID） |
| 追溯 | 按批次、按订单 | 数据一致性 |
| 监控 | /metrics | 完成率、领料准确率、设备稼动率 |
| 配置 | /config/retention | 操作日志留存≥1 年 |

## 3. 性能测试要点

- 生产订单列表分页（page、pageSize）、大数据量下响应时间。
- 批量报工 100+ 工序单次请求成功率与耗时。
- /metrics 接口响应时间（供监控采集）。

## 4. 追溯性测试要点

- 生产入库后，trace/order、trace/lot 可查询到对应记录。
- 批次号、订单号与入库单、报工记录关联一致。

## 5. 通过标准（工业级）

- 领料超领时返回 400 及商用提示，不出现负库存或静默失败。
- 生产入库同一 X-Request-ID 重复提交返回 200 及原记录。
- 车间过滤生效：带 X-Workshop-Id 时仅返回该车间订单。
- 操作日志留存配置≥365 天。

## 6. 测试结果记录（示例）

| 用例 | 预期 | 结果 |
|------|------|------|
| 领料超领 | 400，BUSINESS_RULE_VIOLATION | 待执行 |
| 生产入库幂等 | 201 首次，200 重复 | 待执行 |
| 批量报工 150 条 | 201，count=150 | 待执行 |
| 车间过滤 | 仅本车间订单 | 待执行 |

（实际执行时请填写日期、执行人、通过/失败及备注。）
