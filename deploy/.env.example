# SuperPaaS 部署配置（复制为 .env 后按需修改）
# 遵循解耦原则：细胞仅通过 PORT 配置，路由由网关环境变量注入

# ---------- 宿主机映射端口 ----------
GATEWAY_PORT=8000
GOVERNANCE_PORT=8005
MONITOR_PORT=9000
FRONTEND_PORT=5173
FRONTEND_ADMIN_PORT=5174

# ---------- 治理中心（网关接入后启用发现与 RED 上报） ----------
# GOVERNANCE_URL=http://governance:8005

# ---------- 对外访问地址（E2E / 浏览器） ----------
GATEWAY_URL=http://localhost:8000
MONITOR_CENTER_URL=http://localhost:9000

# ---------- 细胞路由（由 docker-compose 注入，无需在此配置） ----------
# 若单独启动网关，可在此指定 CELL_*_URL，例如：
# CELL_CRM_URL=http://crm-cell:8001
# CELL_ERP_URL=http://erp-cell:8002
# ... 其余见 docker-compose.yml

# ---------- 可选：网关路由文件（替代环境变量） ----------
# GATEWAY_ROUTES_PATH=./gateway_route_spec.yaml

# ---------- 安全：生产必须禁用 Mock 认证 ----------
# 生产环境设为 0，并对接认证中心；否则登录使用内置弱口令（仅演示）
# GATEWAY_USE_MOCK_AUTH=0
# 登录接口限流（每 IP 每分钟次数），防暴力破解
# GATEWAY_LOGIN_RATE_PER_IP_PER_MIN=10

# ---------- 可选：认证/多租户 ----------
# 生产环境建议设为 1：要求请求头携带 X-Tenant-Id，否则 400（商用化多租户隔离）
# GATEWAY_REQUIRE_TENANT_ID=0
# 多租户校验与配额：1=校验租户有效（存在/启用/未到期）及请求量配额，超配额 429
# GATEWAY_VALIDATE_TENANT=0
# 租户默认请求量配额（0=不限制，仅当该租户未单独配置时生效）
# TENANT_QUOTA_DEFAULT_REQUESTS_PER_MIN=0
# API_KEY=your-api-key-placeholder
# JWT_SECRET=your-jwt-secret-placeholder
# DEFAULT_TENANT_ID=tenant-001

# ---------- 可选：自愈 ----------
# SUPPAAS_AUTO_HEAL_RESTART=0

# ---------- 高可用：网关集群与会话持久化 ----------
# Redis 会话存储（多实例网关共享 Token，避免单点；不配置则单机内存）
# GATEWAY_SESSION_STORE_URL=redis://redis:6379/0
# GATEWAY_SESSION_TTL_SEC=86400
# 代理转发重试（5xx 或网络错误时重试次数，默认 2）
# GATEWAY_PROXY_RETRY_COUNT=2
# GATEWAY_PROXY_TIMEOUT_SEC=30
# ---------- 性能与压测（商用建议：连接池+GET 缓存） ----------
# USE_REAL_FORWARD=1 必须开启，否则连接池与缓存不生效
# 连接池：支持 500+ 并发（代码默认已调大，可覆盖）
# GATEWAY_POOL_NUM_POOLS=64
# GATEWAY_POOL_MAXSIZE=16
# GET 缓存：列表/健康等读多接口，减少细胞穿透（0=关闭）
# GATEWAY_GET_CACHE_TTL_SEC=10
# GATEWAY_GET_CACHE_MAX=1000
# 熔断器可调参数（可选）
# GATEWAY_CB_WINDOW_SEC=10
# GATEWAY_CB_FAILURE_RATIO=0.5
# GATEWAY_CB_HALF_OPEN_PROBES=3
# GATEWAY_CB_PROBE_SUCCESSES_TO_CLOSE=2

# ---------- 高可用：治理中心发现与健康 ----------
# GOVERNANCE_HEALTH_INTERVAL_SEC=30
# GOVERNANCE_HEALTH_FAILURE_THRESHOLD=3
# GOVERNANCE_HEALTH_TIMEOUT_SEC=5
# GOVERNANCE_DISCOVERY_RETRY=2
# GOVERNANCE_DISCOVERY_TIMEOUT=5
# GOVERNANCE_DISCOVERY_BACKOFF_BASE=0.2
