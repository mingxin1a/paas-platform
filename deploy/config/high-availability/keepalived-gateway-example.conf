# Keepalived 主备示例（网关 VIP 故障转移）
# 主备节点各运行一份，通过 priority 与 state 区分；VIP 漂移到 MASTER
# 需配合脚本对 /health 做健康检查并降权，实现故障自动转移（详见部署手册）

global_defs {
    router_id superpaas_gateway
}

vrrp_script check_gateway_health {
    script "/usr/local/bin/check_gateway_health.sh"
    interval 5
    weight -20
    fall 2
    rise 1
}

vrrp_instance VI_GATEWAY {
    state MASTER
    interface eth0
    virtual_router_id 51
    priority 100
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass your_secure_password
    }
    virtual_ipaddress {
        192.168.1.100/24
    }
    track_script {
        check_gateway_health
    }
}

# 备节点：state BACKUP，priority 90，其余 virtual_router_id/auth 与主一致
