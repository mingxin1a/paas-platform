# 批次1 细胞（CRM/ERP/OA/SRM）Deployment 与 Service 模板
# 每个细胞独立 Deployment、独立 Service；数据库按细胞独立（见备份脚本）
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cell-crm
  namespace: paas
  labels:
    app: cell-crm
spec:
  replicas: 2
  selector:
    matchLabels:
      app: cell-crm
  template:
    metadata:
      labels:
        app: cell-crm
    spec:
      containers:
        - name: crm
          image: superpaas/cell-crm:latest
          ports:
            - containerPort: 8001
          livenessProbe:
            httpGet:
              path: /health
              port: 8001
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
---
apiVersion: v1
kind: Service
metadata:
  name: cell-crm
  namespace: paas
spec:
  selector:
    app: cell-crm
  ports:
    - port: 8001
      targetPort: 8001
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cell-erp
  namespace: paas
  labels:
    app: cell-erp
spec:
  replicas: 2
  selector:
    matchLabels:
      app: cell-erp
  template:
    metadata:
      labels:
        app: cell-erp
    spec:
      containers:
        - name: erp
          image: superpaas/cell-erp:latest
          ports:
            - containerPort: 8002
          livenessProbe:
            httpGet:
              path: /health
              port: 8002
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
---
apiVersion: v1
kind: Service
metadata:
  name: cell-erp
  namespace: paas
spec:
  selector:
    app: cell-erp
  ports:
    - port: 8002
      targetPort: 8002
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cell-oa
  namespace: paas
  labels:
    app: cell-oa
spec:
  replicas: 2
  selector:
    matchLabels:
      app: cell-oa
  template:
    metadata:
      labels:
        app: cell-oa
    spec:
      containers:
        - name: oa
          image: superpaas/cell-oa:latest
          ports:
            - containerPort: 8005
          livenessProbe:
            httpGet:
              path: /health
              port: 8005
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
---
apiVersion: v1
kind: Service
metadata:
  name: cell-oa
  namespace: paas
spec:
  selector:
    app: cell-oa
  ports:
    - port: 8005
      targetPort: 8005
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cell-srm
  namespace: paas
  labels:
    app: cell-srm
spec:
  replicas: 2
  selector:
    matchLabels:
      app: cell-srm
  template:
    metadata:
      labels:
        app: cell-srm
    spec:
      containers:
        - name: srm
          image: superpaas/cell-srm:latest
          ports:
            - containerPort: 8008
          livenessProbe:
            httpGet:
              path: /health
              port: 8008
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            requests:
              memory: "128Mi"
              cpu: "50m"
---
apiVersion: v1
kind: Service
metadata:
  name: cell-srm
  namespace: paas
spec:
  selector:
    app: cell-srm
  ports:
    - port: 8008
      targetPort: 8008
  type: ClusterIP
